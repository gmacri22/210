<!--
Authors: Gianna Macri, Mario Natalino
Project: Backpack
Last updated: 2015 November 19
-->

<html>
<head>
<title>Backpack Login</title>
<meta name="description" content="Login to Backpack">
<meta name="author" content="Gianna Macri, Mario Natalino"
<meta charset="UTF-8">

<script src="//code.jquery.com/jquery-1.11.3.min.js"></script>

<script type="text/javascript">
$(document).ready(function() {
  // Superb error handling!
  $(document).ajaxError(function() {
    alert("Sorry, there was a problem!");
  });
  // Button handlers
  $("#createButton").click(function() {
    $.ajax({
      // CREATE 
      url: "login/",
      type: "POST",
      dataType : "text", 
      data : { username: $("#nameBox").val(),
               password: $("#passwordBox").val()
             },
      success: function( data ) {
        console.log("You received some data!", data);
        if (data == 'OK') {
          $("#status").html("Successfully created a new user!");
        } else {
          $("#status").html("Error: could not create a new user!");
        }
      },
    });
  });
  $("#loginButton").click(function() {
	$.ajax({
	  // READ
      url: "login/" + $("#nameBox").val() + "&"+$("#passwordBox").val(),
      type: "GET",
      dataType : "json", 
      success: function( data ) {
        console.log("You received some data!", data);
        if (data.username && data.password) {
          $("#nameDiv").html("My name is " + data.username);
          $("#passDiv").html("My password is " + data.password);
          window.location.replace("http://localhost:3000/backpack.html");
        } else {
          $("#status").html("Error: could not find user!");
          // clear the profile display
          $("#nameDiv").html("");
          $("#passDiv").html("");
          $("#profileImage").attr("src", "");
        }
      },
    });

  });
});
</script>

</head>
  <body>
  <h1>Backpack</h1>

    <p>
    Username: <input id="nameBox" type="text" size="20"/>
    Password: <input id="passwordBox" type="text" size="20"/>
    </p>

    <p>
    <button id="createButton">Create an account</button>
    <button id="loginButton">Login</button>
    </p>

    <!-- empty placeholders -->
    <div id="nameDiv"></div>
    <div id="passDiv"></div>

    <hr/>

    <div id="status"></div>
  </body>
</html>
